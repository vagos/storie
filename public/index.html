<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KV Store</title>
  <script src="https://js.stripe.com/v3/"></script>
</head>
<body>
  <div class="card">
    <h1>KV Store</h1>
    <p>Simple key-value store. Free accounts can use one key; premium unlocks unlimited keys. Log in to manage your data.</p>

    <section id="loginSection">
      <h2>Create or log in</h2>
      <label for="userId">User ID</label>
      <input id="userId" type="text" placeholder="alice123" />
      <label for="password">Password</label>
      <input id="password" type="password" placeholder="••••" />
      <div>All accounts start as <strong>free</strong>. Upgrade to premium after logging in.</div>
      <button id="createUserBtn">Create or Login</button>
      <div id="loginStatus">Not logged in.</div>
    </section>

    <section id="dashboard" style="display: none;">
      <div>
        <strong id="currentUser">Current user: none</strong>
        <button id="logoutBtn">Log out</button>
      </div>

      <h2>KV operations</h2>
      <label for="key">Key</label>
      <input id="key" type="text" placeholder="example-key" />

      <label for="value">Value (text or JSON)</label>
      <textarea id="value" placeholder='{ "message": "hello" }'></textarea>

      <label><input type="checkbox" id="requireSecret"> Protect this key (secret generated automatically)</label>

      <div class="actions">
        <button id="setBtn">Set Value</button>
        <button class="secondary" id="getBtn">Get Value</button>
        <button class="secondary" id="clearBtn">Clear Output</button>
      </div>

      <pre id="output">Waiting for input…</pre>

      <h2>Your keys</h2>
      <div id="tableStatus">No data loaded.</div>
      <table border="1" width="100%" cellpadding="6">
        <thead>
          <tr>
            <th>Key</th>
            <th>Value</th>
            <th>Updated</th>
          </tr>
        </thead>
        <tbody id="entriesBody">
        </tbody>
      </table>
      <div class="actions">
        <button class="secondary" id="prevPageBtn">Prev</button>
        <span id="pageInfo"></span>
        <button class="secondary" id="nextPageBtn">Next</button>
      </div>

      <h2>Upgrade to premium</h2>
      <p>Start a Stripe checkout and confirm to unlock unlimited keys. Requires server STRIPE_SECRET_KEY.</p>
      <button id="startCheckoutBtn">Start Stripe checkout</button>
      <div id="paymentInfo"></div>
    </section>

    <section id="infoSection">
      <h2>Info</h2>
      <p>
        GitHub: <a href="https://github.com/vagos/storie" target="_blank" rel="noreferrer">https://github.com/vagos/storie</a><br />
        Support: <a href="mailto:vagos@lamprou.xyz">vagos@lamprou.xyz</a>
      </p>
    </section>
  </div>

  <script src="index.js" defer></script>
</body>
</html>
